{% extends "base.html" %}
{% block title %}MenÃº Principal{% endblock %}
{% block content %}
<div class="card menu-grid">
  <a href="{{ url_for('lista_gallos') }}" class="btn">ğŸ“‹ Mis Gallos</a>
  <a href="{{ url_for('cruce_inbreeding') }}" class="btn">ğŸ” Cruce Inbreeding</a>
  <a href="{{ url_for('buscar') }}" class="btn">ğŸ” Buscar</a>
  <a href="javascript:void(0);" class="btn" onclick="crearBackup()">ğŸ’¾ Respaldo</a>
  <a href="{{ url_for('cerrar_sesion') }}" class="btn btn-secondary">ğŸšª Cerrar SesiÃ³n</a>
</div>
<div id="mensaje-backup" class="mensaje-backup"></div>
{% endblock %}

{% block head %}
<script>
function crearBackup() {
  fetch("/backup", { method: "POST" })
  .then(r => r.json())
  .then(d => {
    const msg = document.getElementById("mensaje-backup");
    if(d.error) msg.innerHTML = `<span class="error-texto">âŒ ${d.error}</span>`;
    else {
      msg.innerHTML = `<span class="success-texto">${d.mensaje}</span>`;
      window.location.href = "/download/" + d.archivo;
    }
  }).catch(err => {
    document.getElementById("mensaje-backup").innerHTML = `<span class="error-texto">âŒ Error de red.</span>`;
  });
}
</script>
{% endblock %}
